# Налаштування пристрою

Сторінка "Пристрій" у налаштуваннях машини дозволяє зчитувати та застосовувати налаштування безпосередньо до вашого підключеного пристрою (контролера). Вони також відомі як "dollar settings" або налаштування `$$` у GRBL.

![Налаштування пристрою](/screenshots/machine-device.png)

:::увага Обережно при зміні налаштувань
Неправильні налаштування прошивки можуть призвести до непередбачуваної поведінки машини, втрати позиції або навіть пошкодження обладнання. Завжди записуйте вихідні значення перед внесенням змін і змінюйте одне налаштування за раз.
:::

## Огляд

Сторінка "Пристрій" забезпечує прямий доступ до налаштувань прошивки вашого контролера. Тут ви можете:

- Зчитувати поточні налаштування з пристрою
- Змінювати окремі налаштування
- Застосовувати зміни до пристрою

Налаштування прошивки контролюють:

- **Параметри руху**: Обмеження швидкості, прискорення, калібрування
- **Кінцеві вимикачі**: Поведінка homing, програмні/апаратні обмеження
- **Керування лазером**: Діапазон потужності, увімкнення режиму лазера
- **Електрична конфігурація**: Інверсія пінів, підтяжки
- **Звітність**: Формат та частота статусних повідомлень

Ці налаштування зберігаються на вашому контролері (не в Rayforge) і зберігаються після циклів живлення.

## Зчитування налаштувань

Натисніть кнопку **Зчитати з пристрою**, щоб отримати поточні налаштування з підключеного контролера. Це вимагає:

- Підключення машини
- Щоб драйвер підтримував зчитування налаштувань пристрою

## Застосування налаштувань

Після зміни налаштувань зміни застосовуються до пристрою. Пристрій може:

- Тимчасово перезавантажитися
- Відключитися та повторно підключитися
- Потребувати циклу живлення для деяких змін

## Доступ до консолі

Ви також можете переглядати/змінювати налаштування через консоль G-code:

**Переглянути всі налаштування:**
```
$$
```

**Переглянути одне налаштування:**
```
$100
```

**Змінити налаштування:**
```
$100=80.0
```

**Відновити значення за замовчуванням:**
```
$RST=$
```

:::небезпека Відновлення значень за замовчуванням видаляє всі налаштування
Команда `$RST=$` скидає всі налаштування GRBL до заводських значень за замовчуванням. Ви втратите будь-яке калібрування та налаштування. Спочатку зробіть резервну копію налаштувань!
:::

---

## Критичні налаштування для лазерів

Ці налаштування найважливіші для роботи лазера:

### $32 - Режим лазера

**Значення:** 0 = Вимкнено, 1 = Увімкнено

**Призначення:** Увімкнення специфічних для лазера функцій у GRBL

**Коли увімкнено (1):**
- Лазер автоматично вимикається під час переміщень G0 (швидких)
- Потужність динамічно регулюється під час прискорення/сповільнення
- Запобігає випадковим опікам під час позиціонування

**Коли вимкнено (0):**
- Лазер поводиться як шпиндель (режим CNC)
- Не вимикається під час швидких переміщень
- **Небезпечно для використання лазера!**

:::увага Завжди вмикайте режим лазера
$32 має **завжди** бути встановлено на 1 для лазерних різаків. Вимкнений режим лазера може спричинити ненавмисні опіки та пожежонебезпеку.
:::

### $30 та $31 - Діапазон потужності лазера

**$30 - Максимальна потужність лазера (RPM)**
**$31 - Мінімальна потужність лазера (RPM)**

**Призначення:** Визначає діапазон потужності для команд S

**Типові значення:**
- $30=1000, $31=0 (діапазон S0-S1000, найпоширеніший)
- $30=255, $31=0 (діапазон S0-S255, деякі контролери)

:::порада Відповідність конфігурації Rayforge
Налаштування "Максимальна потужність" у ваших [Налаштуваннях лазера](laser) має відповідати вашому значенню $30. Якщо $30=1000, встановіть максимальну потужність на 1000 в Rayforge.
:::

### $130 та $131 - Максимальний хід

**$130 - Максимальний хід X (мм)**
**$131 - Максимальний хід Y (мм)**

**Призначення:** Визначає робочу область вашої машини

**Чому це важливо:**
- Програмні обмеження ($20) використовують ці значення для запобігання зіткненням
- Визначає межі системи координат
- Має відповідати фізичному розміру вашої машини

---

## Довідник налаштувань

### Конфігурація степерів ($0-$6)

Контролює електричні сигнали та таймінги степерних двигунів.

| Налаштування | Опис | Типове значення |
|---------|-------------|---------------|
| $0 | Час імпульсу кроку (мкс) | 10 |
| $1 | Затримка холостого ходу кроку (мс) | 25 |
| $2 | Інверсія імпульсу кроку (маска) | 0 |
| $3 | Інверсія напрямку кроку (маска) | 0 |
| $4 | Інвертувати пін увімкнення кроку | 0 |
| $5 | Інвертувати піни обмежень | 0 |
| $6 | Інвертувати пін зонда | 0 |

### Обмеження та Homing ($20-$27)

Контролює кінцеві вимикачі та поведінку homing.

| Налаштування | Опис | Типове значення |
|---------|-------------|---------------|
| $20 | Увімкнути програмні обмеження | 0 або 1 |
| $21 | Увімкнути апаратні обмеження | 0 |
| $22 | Увімкнути цикл homing | 0 або 1 |
| $23 | Інверсія напрямку homing | 0 |
| $24 | Швидкість пошуку homing (мм/хв) | 25 |
| $25 | Швидкість пошуку homing (мм/хв) | 500 |
| $26 | Затримка debounce homing (мс) | 250 |
| $27 | Відстань відведення homing (мм) | 1.0 |

### Шпиндель та лазер ($30-$32)

| Налаштування | Опис | Значення для лазера |
|---------|-------------|-------------|
| $30 | Максимальна швидкість шпинделя | 1000.0 |
| $31 | Мінімальна швидкість шпинделя | 0.0 |
| $32 | Увімкнути режим лазера | 1 |

### Калібрування осей ($100-$102)

Визначає, скільки кроків степерного двигуна дорівнює одному міліметру переміщення.

| Налаштування | Опис | Примітки |
|---------|-------------|-------|
| $100 | Кроків/мм X | Залежить від співвідношення шків/ремінь |
| $101 | Кроків/мм Y | Зазвичай таке ж як X |
| $102 | Кроків/мм Z | Не використовується на більшості лазерів |

**Розрахунок кроків/мм:**
```
кроків/мм = (кроків_двигуна_на_оберт × мікрокрокування) / (зубців_шківа × крок_ременя)
```

**Приклад:** 200 кроків/оберт, 16 мікрокроків, шків 20 зубців, ремінь GT2:
```
кроків/мм = (200 × 16) / (20 × 2) = 3200 / 40 = 80
```

### Швидкість та прискорення осей ($110-$122)

| Налаштування | Опис | Типове значення |
|---------|-------------|---------------|
| $110 | Макс. швидкість X (мм/хв) | 5000.0 |
| $111 | Макс. швидкість Y (мм/хв) | 5000.0 |
| $112 | Макс. швидкість Z (мм/хв) | 500.0 |
| $120 | Прискорення X (мм/сек²) | 500.0 |
| $121 | Прискорення Y (мм/сек²) | 500.0 |
| $122 | Прискорення Z (мм/сек²) | 100.0 |

### Хід осей ($130-$132)

| Налаштування | Опис | Примітки |
|---------|-------------|-------|
| $130 | Макс. хід X (мм) | Ширина робочої області |
| $131 | Макс. хід Y (мм) | Глибина робочої області |
| $132 | Макс. хід Z (мм) | Хід Z (якщо застосовно) |

---

## Приклад типової конфігурації

### Типовий діодний лазер (300×400мм)

```gcode
$0=10          ; Імпульс кроку 10мкс
$1=255         ; Затримка холостого ходу кроку 255мс
$2=0           ; Без інверсії кроку
$3=0           ; Без інверсії напрямку
$4=0           ; Без інверсії увімкнення
$5=0           ; Без інверсії обмежень
$10=1          ; Звіт WPos
$11=0.010      ; Відхилення сполучення 0.01мм
$12=0.002      ; Толерантність дуги 0.002мм
$13=0          ; Звіт у мм
$20=1          ; Програмні обмеження увімкнено
$21=0          ; Апаратні обмеження вимкнено
$22=1          ; Homing увімкнено
$23=0          ; Home до мінімуму
$24=50.0       ; Подача homing 50мм/хв
$25=1000.0     ; Пошук homing 1000мм/хв
$26=250        ; Debounce homing 250мс
$27=2.0        ; Відведення homing 2мм
$30=1000.0     ; Макс. потужність S1000
$31=0.0        ; Мін. потужність S0
$32=1          ; Режим лазера УВІМКНЕНО
$100=80.0      ; Кроків/мм X
$101=80.0      ; Кроків/мм Y
$102=80.0      ; Кроків/мм Z
$110=5000.0    ; Макс. швидкість X
$111=5000.0    ; Макс. швидкість Y
$112=500.0     ; Макс. швидкість Z
$120=500.0     ; Прискорення X
$121=500.0     ; Прискорення Y
$122=100.0     ; Прискорення Z
$130=400.0     ; Макс. хід X
$131=300.0     ; Макс. хід Y
$132=0.0       ; Макс. хід Z
```

---

## Резервне копіювання налаштувань

### Процедура резервного копіювання

1. **Через Rayforge:**
   - Відкрийте панель налаштувань пристрою
   - Натисніть "Експортувати налаштування"
   - Збережіть файл як `grml-backup-YYYY-MM-DD.txt`

2. **Через консоль:**
   - Надішліть команду `$$`
   - Скопіюйте весь вивід у текстовий файл
   - Збережіть з датою

### Процедура відновлення

1. Відкрийте файл резервної копії
2. Надішліть кожен рядок (`$100=80.0` тощо) через консоль
3. Перевірте командою `$$`

:::порада Регулярні резервні копії
Робіть резервні копії налаштувань після будь-якого калібрування або налаштування. Зберігайте резервні копії в безпечному місці.
:::

---

## Дивіться також

- [Загальні налаштування](general) - Назва машини та налаштування швидкості
- [Налаштування лазера](laser) - Конфігурація лазерної головки
- [Виправлення проблем підключення](../troubleshooting/connection) - Виправлення проблем з підключенням

## Зовнішні ресурси

- [GRBL v1.1 Configuration](https://github.com/gnea/grbl/wiki/Grbl-v1.1-Configuration)
- [GRBL v1.1 Commands](https://github.com/gnea/grbl/wiki/Grbl-v1.1-Commands)
- [Grbl_ESP32 Documentation](https://github.com/bdring/Grbl_Esp32/wiki)
