# Проблеми з підключенням

Ця сторінка допомагає діагностувати та вирішити проблеми підключення Rayforge до вашої лазерної машини через послідовне з'єднання.

## Швидка діагностика

### Симптоми

Поширені проблеми підключення включають:

- Помилка "Порт має бути налаштований" при спробі підключення
- Підключення постійно зазнає невдачі та перепідключається
- Послідовний порт не з'являється в списку портів
- Помилки "Відмовлено в дозволі" при спробі відкрити послідовний порт
- Пристрій здається підключеним, але не відповідає на команди

---

## Поширені проблеми та рішення

### Послідовні порти не виявлено

**Проблема:** Випадаючий список послідовних портів порожній або не показує ваш пристрій.

**Діагностика:**

1. Перевірте, чи ваш пристрій увімкнено та підключено через USB
2. Спробуйте відключити та знову підключити USB-кабель
3. Протестуйте USB-кабель з іншим пристроєм (кабелі можуть виходити з ладу)
4. Спробуйте інший USB-порт на вашому комп'ютері

**Рішення:**

**Linux:**
Якщо ви використовуєте версію Snap, вам потрібно надати дозволи на послідовний порт:

```bash
sudo snap connect rayforge:serial-port
```

Див. [Дозволи Snap](snap-permissions) для детального налаштування Linux.

Для встановлень не через Snap додайте свого користувача до групи `dialout`:

```bash
sudo usermod -a -G dialout $USER
```

Потім вийдіть з системи та зайдіть знову, щоб зміни набрали чинності.

**Windows:**
1. Відкрийте Диспетчер пристроїв (Win+X, потім виберіть Диспетчер пристроїв)
2. Шукайте під "Порти (COM та LPT)" ваш пристрій
3. Якщо бачите жовтий значок попередження, оновіть або перевстановіть драйвер
4. Запишіть номер COM-порту (наприклад, COM3)
5. Якщо пристрій взагалі не в списку, USB-кабель або драйвер може бути несправним

**macOS:**
1. Перевірте Системну інформацію → USB щоб переконатися, що пристрій розпізнається
2. Встановіть драйвери CH340/CH341, якщо ваш контролер використовує цей чіпсет
3. Шукайте пристрої `/dev/tty.usbserial*` або `/dev/cu.usbserial*`

### Помилки "Відмовлено в дозволі"

**Проблема:** Ви отримуєте помилки "Відмовлено в дозволі" або подібні при спробі підключення.

**На Linux (не Snap):**

Вашому користувачу потрібно бути в групі `dialout` (або `uucp` на деяких дистрибутивах):

```bash
# Додайте себе до групи dialout
sudo usermod -a -G dialout $USER

# Перевірте, що ви в групі (після виходу/входу)
groups | grep dialout
```

**Важливо:** Ви повинні вийти з системи та зайти знову (або перезавантажити) щоб зміни групи набрали чинності.

**На Linux (Snap):**

Надайте доступ до послідовного порту snap-пакету:

```bash
sudo snap connect rayforge:serial-port
```

Див. посібник [Дозволи Snap](snap-permissions) для деталей.

**На Windows:**

Закрийте будь-які інші програми, які можуть використовувати послідовний порт, включаючи:
- Попередні екземпляри Rayforge
- Інструменти моніторингу послідовного порту
- Інше лазерне ПЗ
- Arduino IDE або подібні інструменти

### Вибрано неправильний послідовний порт

**Проблема:** Rayforge підключається, але машина не відповідає.

**Діагностика:**

Ви могли вибрати неправильний порт, особливо якщо у вас підключено кілька USB-пристроїв.

**Рішення:**

1. Відключіть усі інші USB послідовні пристрої
2. Запишіть, які порти доступні в Rayforge
3. Підключіть ваш лазерний контролер
4. Оновіть список портів - новий порт і є вашим лазером
5. На Linux лазерні контролери зазвичай з'являються як:
    - `/dev/ttyUSB0` (поширено для чіпсетів CH340)
    - `/dev/ttyACM0` (поширено для нативних USB контролерів)
6. На Windows запишіть COM-порт з Диспетчера пристроїв
7. Уникайте портів з назвою `/dev/ttyS*` на Linux - це апаратні послідовні порти, не USB

:::увага Апаратні послідовні порти
Rayforge попередить вас, якщо ви виберете порти `/dev/ttyS*` на Linux, оскільки вони зазвичай не є USB-пристроями GRBL. USB послідовні порти використовують `/dev/ttyUSB*` або `/dev/ttyACM*`.
:::


### Неправильна швидкість передачі

**Проблема:** Підключення встановлюється, але команди не працюють або дають спотворені відповіді.

**Рішення:**

Контролери GRBL зазвичай використовують одну з цих швидкостей передачі:

- **115200** (найпоширеніша, GRBL 1.1+)
- **9600** (старіші версії GRBL)
- **250000** (менш поширена, деяка власна прошивка)

Спробуйте різні швидкості передачі в налаштуваннях пристрою Rayforge. Найпоширеніша - **115200**.

### Підключення постійно розривається

**Проблема:** Rayforge успішно підключається, але постійно відключається та перепідключається.

**Можливі причини:**

1. **Ненадійний USB-кабель** - Замініть на відомий робочий кабель (бажано короткий, <2м)
2. **Проблеми з живленням USB** - Спробуйте інший USB-порт, бажано на самому комп'ютері, а не на хабі
3. **EMI/Перешкоди** - Тримайте USB-кабелі подалі від проводів двигунів та високовольтних блоків живлення
4. **Проблеми прошивки** - Оновіть прошивку GRBL якщо можливо
5. **Конфлікти USB-портів** - На Windows спробуйте різні USB-порти

**Кроки усунення неполадок:**

```bash
# На Linux моніторте системні логи під час підключення:
sudo dmesg -w
```

Шукайте повідомлення типу:
- "USB disconnect" - вказує на фізичні проблеми/проблеми з кабелем
- "device descriptor read error" - часто проблема з живленням або кабелем

### Пристрій не відповідає після підключення

**Проблема:** Статус підключення показує "Підключено", але машина не відповідає на команди.

**Діагностика:**

1. Перевірте, що вибрано правильний тип прошивки (GRBL або інший)
2. Переконайтеся, що машина увімкнена (контролер та блок живлення)
3. Перевірте, чи машина в стані аварії (потребує homing або очищення аварії)

**Рішення:**

Спробуйте надіслати ручну команду в Консолі:

- `?` - Запит звіту про статус
- `$X` - Очистити аварію
- `$H` - Виконати homing машини

Якщо немає відповіді, перевірте швидкість передачі та вибір порту.

---

## Повідомлення про статус підключення

Rayforge показує різні стани підключення:

| Статус | Значення | Дія |
|--------|---------|--------|
| **Відключено** | Не підключено до жодного пристрою | Налаштуйте порт та підключіться |
| **Підключення** | Спроба встановити з'єднання | Чекайте, або перевірте конфігурацію якщо зависло |
| **Підключено** | Успішно підключено та отримується статус | Готово до використання |
| **Помилка** | Підключення не вдалося з помилкою | Перевірте повідомлення про помилку для деталей |
| **Очікування** | Очікування перед спробою перепідключення | Попереднє підключення не вдалося, повтор через 5с |

---

## Тестування вашого підключення

### Покроковий тест підключення

1. **Налаштуйте машину:**
    - Відкрийте Налаштування  Машина
    - Виберіть або створіть профіль машини
    - Виберіть правильний драйвер (GRBL Serial)
    - Виберіть послідовний порт
    - Встановіть швидкість передачі (зазвичай 115200)

2. **Спробуйте підключення:**
    - Натисніть "Підключити" на панелі керування машиною
    - Спостерігайте за індикатором статусу підключення

3. **Перевірте зв'язок:**
    - Якщо підключено, спробуйте надіслати запит статусу
    - Машина має повідомити свою позицію та стан

4. **Протестуйте базові команди:**
    - Спробуйте homing (`$H`) якщо ваша машина має кінцеві вимикачі
    - Або очистіть аварії (`$X`) якщо потрібно

### Використання debug-логів

Rayforge включає детальне логування для проблем підключення. Щоб увімкнути debug-логування:

```bash
# Запустіть Rayforge з терміналу з debug-логуванням
rayforge --loglevel DEBUG
```

Перевірте логи на:
- Спроби підключення та невдачі
- Послідовні дані передані (TX) та отримані (RX)
- Повідомлення про помилки з трасуванням стека

---

## Розширене усунення неполадок

### Ручна перевірка доступності порту

**Linux:**
```bash
# Список всіх USB послідовних пристроїв
ls -l /dev/ttyUSB* /dev/ttyACM*

# Перевірте дозволи
ls -l /dev/ttyUSB0  # Замініть на ваш порт

# Має показати: crw-rw---- 1 root dialout
# Вам потрібно бути в групі 'dialout'

# Протестуйте порт вручну
sudo minicom -D /dev/ttyUSB0 -b 115200
```

**Windows:**
```powershell
# Список COM-портів в PowerShell
[System.IO.Ports.SerialPort]::getportnames()

# Або використовуйте Диспетчер пристроїв:
# Win + X → Диспетчер пристроїв → Порти (COM та LPT)
```

### Сумісність прошивки

Rayforge розроблений для прошивок, сумісних з GRBL. Переконайтеся, що ваш контролер використовує:

- **GRBL 1.1** (найпоширеніша, рекомендується)
- **GRBL 0.9** (старіша, може мати обмежені функції)
- **grblHAL** (сучасний форк GRBL, підтримується)

Інші типи прошивок (Marlin, Smoothieware) наразі не підтримуються через драйвер GRBL.

### USB-до-послідовних чіпсетів

Поширені чіпсети та їхні драйвери:

| Чіпсет | Linux | Windows | macOS |
|---------|-------|---------|-------|
| **CH340/CH341** | Вбудований драйвер ядра | [CH341SER драйвер](http://www.wch.cn/downloads/) | Потребує драйвер |
| **FTDI FT232** | Вбудований драйвер ядра | Вбудований (Windows 10+) | Вбудований |
| **CP2102 (SiLabs)** | Вбудований драйвер ядра | Вбудований (Windows 10+) | Вбудований |

---

## Все ще є проблеми?

Якщо ви спробували все вище і все ще не можете підключитися:

1. **Перевірте GitHub issues** - Хтось міг повідомити про ту саму проблему
2. **Створіть детальний звіт про проблему** з:
    - Операційна система та версія
    - Версія Rayforge (Snap/Flatpak/AppImage/з вихідних кодів)
    - Модель плати контролера та версія прошивки
    - USB чіпсет (перевірте Диспетчер пристроїв на Windows або `lsusb` на Linux)
    - Повні повідомлення про помилки та debug-логи
3. **Протестуйте з іншою програмою** - Спробуйте підключитися з серійним терміналом (minicom, PuTTY, Arduino Serial Monitor) щоб перевірити, що обладнання працює

---

## Пов'язані сторінки

- [Дозволи Snap](snap-permissions) - Налаштування дозволів Linux Snap
- [Режим debug](debug) - Увімкнути діагностичне логування
- [Загальні налаштування](../machine/general) - Посібник з налаштування машини
- [Налаштування пристрою](../machine/device) - Довідник конфігурації GRBL
