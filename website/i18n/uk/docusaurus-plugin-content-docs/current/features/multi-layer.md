# Багатошаровий робочий процес

Багатошарова система Rayforge дозволяє організовувати складні роботи в окремі етапи обробки, кожен з власними операціями та налаштуваннями. Це необхідно для поєднання різних процесів, таких як гравіювання та різання, або роботи з кількома матеріалами.

## Що таке шари?

**Шар** у Rayforge — це:

- **Контейнер** для заготовок (імпортовані форми, зображення, текст)
- **Робочий процес**, що визначає, як ці заготовки обробляються
- **Етап**, що обробляється послідовно під час робіт

**Ключове поняття:** Шари обробляються по порядку, один за одним, дозволяючи
вам контролювати послідовність операцій.

:::note Шари та заготовки
Шар містить одну або більше заготовок. При імпорті SVG-файлів з
шарами кожен шар з вашого дизайну стає окремим шаром у Rayforge.
Це дозволяє зберегти організацію вашого дизайну саме так, як ви його створили.
:::


---

## Чому використовувати кілька шарів?

### Поширені випадки використання

**1. Гравіювання, потім різання**

Найпоширеніший багатошаровий робочий процес:

- **Шар 1:** Растрове гравіювання дизайну
- **Шар 2:** Контурне різання контуру

**Чому окремі шари?**

- Гравіювання спочатку гарантує, що деталь не переміщується під час гравіювання
- Різання останнім запобігає падінню деталей до завершення гравіювання
- Різні налаштування потужності/швидкості для кожної операції

**2. Багатопрохідне різання**

Для товстих матеріалів:

- **Шар 1:** Перший прохід при помірній потужності
- **Шар 2:** Другий прохід при повній потужності (та сама геометрія)
- **Шар 3:** Опціональний третій прохід за потреби

**Переваги:**

- Зменшує обгорання порівняно з одним проходом на високій потужності
- Кожен шар може мати різні налаштування швидкості/потужності

**3. Проекти з кількома матеріалами**

Різні матеріали в одній роботі:

- **Шар 1:** Різання акрилових деталей
- **Шар 2:** Гравіювання дерев'яних деталей
- **Шар 3:** Маркування металевих деталей

**Вимоги:**

- Кожен шар націлений на різні області робочого столу
- Різні швидкість/потужність/фокус для кожного матеріалу

**4. Імпорт шарів SVG**

Імпорт SVG-файлів з існуючою структурою шарів:

- **Шар 1:** Елементи гравіювання з SVG
- **Шар 2:** Елементи різання з SVG
- **Шар 3:** Елементи надрізів з SVG

**Робочий процес:**

- Імпортуйте SVG-файл, який має шари
- Увімкніть "Використовувати оригінальні вектори" в діалозі імпорту
- Виберіть, які шари імпортувати зі списку виявлених шарів
- Кожен шар стає окремим шаром у Rayforge

**Вимоги:**

- Ваш SVG-файл повинен використовувати шари (створені в Inkscape або подібному ПЗ)
- Увімкніть "Використовувати оригінальні вектори" при імпорті
- Назви шарів зберігаються з вашого дизайнерського ПЗ

---

## Створення та керування шарами

### Додавання нового шару

1. **Натисніть кнопку "+"** на панелі Шарів
2. **Назвіть шар** описово (наприклад, "Шар гравіювання", "Шар різання")
3. **Шар з'являється** у списку шарів

**За замовчуванням:** Нові документи починаються з одного шару.

### Властивості шару

Кожен шар має:

| Властивість       | Опис                                          |
| ----------------- | --------------------------------------------- |
| **Назва**         | Ім'я, що показується в списку шарів           |
| **Видимість**     | Перемикання видимості на полотні та в перегляді |
| **Заготовка**     | Опціональна прив'язка матеріалу              |
| **Робочий процес**| Операція(ї), що застосовуються до заготовок у цьому шарі |
| **Заготовки**     | Форми/зображення, що містяться в цьому шарі  |

:::note Шари як контейнери
Шари є контейнерами для ваших заготовок. При імпорті SVG-файлів з
шарами кожен шар з вашого дизайну стає окремим шаром у Rayforge.
:::


### Зміна порядку шарів

**Порядок виконання = порядок шарів у списку (зверху вниз)**

Щоб змінити порядок:

1. **Перетягніть** шари на панелі Шарів
2. **Порядок має значення** - шари виконуються зверху вниз

**Приклад:**

```
Панель Шарів:
1. Шар гравіювання     Виконується першим
2. Шар надрізів       Виконується другим
3. Шар різання         Виконується останнім (рекомендується)
```

### Видалення шарів

1. **Виберіть шар** на панелі Шарів
2. **Натисніть кнопку видалення** або натисніть Delete
3. **Підтвердіть видалення** (всі заготовки в шарі видаляються)

:::warning Видалення є остаточним
Видалення шару видаляє всі його заготовки та налаштування робочого процесу. Використовуйте Скасувати,
якщо видалите випадково.
:::


---

## Призначення заготовок шарам

### Ручне призначення

1. **Імпортуйте або створіть** заготовку
2. **Перетягніть заготовку** на бажаний шар на панелі Шарів
3. **Або використовуйте панель властивостей** для зміни шару заготовки

### Імпорт шарів SVG

При імпорті SVG-файлів з увімкненим "Використовувати оригінальні вектори":

1. **Увімкніть "Використовувати оригінальні вектори"** в діалозі імпорту
2. **Rayforge виявляє шари** з вашого SVG-файлу
3. **Виберіть, які шари** імпортувати, використовуючи перемикачі шарів
4. **Кожен вибраний шар** стає окремим шаром з власною заготовкою

:::note Виявлення шарів
Rayforge автоматично виявляє шари з вашого SVG-файлу. Кожен шар,
який ви створили в дизайнерському ПЗ, з'явиться як окремий шар у
Rayforge.
:::


:::note Тільки векторний імпорт
Вибір шарів доступний тільки при використанні прямого векторного імпорту.
При використанні режиму трасування весь SVG обробляється як одна заготовка.
:::


### Переміщення заготовок між шарами

**Перетягування:**

- Виберіть заготовку(и) на полотні або панелі Документа
- Перетягніть на цільов шар на панелі Шарів

**Вирізати та вставити:**

- Виріжте заготовку з поточного шару (Ctrl+X)
- Виберіть цільов шар
- Вставте (Ctrl+V)

### Діалог імпорту SVG

При імпорті SVG-файлів діалог імпорту надає опції, що впливають на
обробку шарів:

**Режим імпорту:**

- **Використовувати оригінальні вектори:** Зберігає ваші векторні шляхи та структуру шарів.
  Коли увімкнено, з'являється розділ "Шари", що показує всі шари з вашого файлу.
- **Режим трасування:** Конвертує SVG у растрове зображення та трасує контури.
  Вибір шарів вимкнено в цьому режимі.

**Розділ Шари (тільки векторний імпорт):**

- Показує всі шари з вашого SVG-файлу
- Кожен шар має перемикач для увімкнення/вимкнення імпорту
- Назви шарів з вашого дизайнерського ПЗ зберігаються
- Тільки вибрані шари імпортуються як окремі шари

:::tip Підготовка SVG-файлів для імпорту шарів
Щоб використовувати імпорт шарів SVG, створіть ваш дизайн з шарами в ПЗ, такому як
Inkscape. Використовуйте панель Шарів для організації вашого дизайну, і Rayforge
збереже цю структуру.
:::


---

## Робочі процеси шарів

Кожен шар має **Робочий процес**, що визначає, як його заготовки обробляються.

### Налаштування робочих процесів шарів

Для кожного шару ви вибираєте тип операції та налаштовуєте її параметри:

**Типи операцій:**

- **Контур** - Слідує контурам (для різання або надрізів)
- **Растрове гравіювання** - Гравіює зображення та заповнює області
- **Гравіювання з глибиною** - Створює гравіювання змінної глибини

**Опціональні покращення:**

- **Лапки** - Малі мости для утримання деталей на місці під час різання
- **Оверскан** - Розширює різи за форму для чистіших країв
- **Компенсація керфа** - Компенсує ширину різу лазера

### Поширені налаштування шарів

**Шар гравіювання:**

- Операція: Растрове гравіювання
- Налаштування: 300-500 DPI, помірна швидкість
- Зазвичай не потребує додаткових опцій

**Шар різання:**

- Операція: Контурне різання
- Опції: Лапки (для утримання деталей), Оверскан (для чистих країв)
- Налаштування: Повільніша швидкість, вища потужність

**Шар надрізів:**

- Операція: Контур (мала потужність, не прорізає наскрізь)
- Налаштування: Низька потужність, висока швидкість
- Призначення: Лінії згину, декоративні лінії

---

## Видимість шарів

Контролюйте, які шари показуються на полотні та в переглядах:

### Видимість на полотні

- **Іконка ока** на панелі Шарів перемикає видимість
- **Приховані шари:**
  - Не показуються на 2D полотні
  - Не показуються в 3D перегляді
  - **Все ще включаються в згенерований G-код**

**Випадки використання:**

- Приховати складні шари гравіювання під час позиціонування шарів різання
- Розібрати полотно при роботі з конкретними шарами
- Зосередитися на одному шарі за раз

### Видимість проти Увімкнено

| Стан                    | Полотно | Перегляд | G-код |
| ----------------------- | ------- | -------- | ----- |
| **Видимий & Увімкнено** | Так     | Так      | Так   |
| **Прихований & Увімкнено** | Ні   | Ні       | Так   |
| **Видимий & Вимкнено** | Так     | Так      | Ні    |
| **Прихований & Вимкнено** | Ні   | Ні       | Ні    |

:::note Вимкнення шарів
:::

Щоб тимчасово виключити шар з робіт без видалення, вимкніть
операцію шару або вимкніть його в налаштуваннях шару.

---

## Порядок виконання шарів

### Як шари обробляються

Під час виконання роботи Rayforge обробляє кожен шар по порядку зверху вниз.
В межах кожного шару всі заготовки обробляються перед переходом до
наступного шару.

### Порядок має значення

**Неправильний порядок:**

```
1. Шар різання
2. Шар гравіювання
```

**Проблема:** Вирізані деталі можуть випасти або переміститися до гравіювання!

**Правильний порядок:**

```
1. Шар гравіювання
2. Шар різання
```

**Чому:** Гравіювання відбувається, поки деталь ще прикріплена, потім різання звільняє її.

### Кілька проходів

Для товстих матеріалів створіть кілька шарів різання:

```
1. Шар гравіювання
2. Шар різання (Прохід 1) - 50% потужність
3. Шар різання (Прохід 2) - 75% потужність
4. Шар різання (Прохід 3) - 100% потужність
```

**Порада:** Використовуйте ту саму геометрію для всіх проходів різання (дублюйте шар).

---

## Розширені техніки

### Групування шарів за матеріалом

Використовуйте шари для організації за матеріалом при виконанні змішаних робіт:

```
Матеріал 1 (3мм акрил):
  - Шар гравіювання акрилу
  - Шар різання акрилу

Матеріал 2 (3мм фанера):
  - Шар гравіювання дерева
  - Шар різання дерева
```

**Робочий процес:**

1. Обробіть всі шари Матеріалу 1
2. Замініть матеріали
3. Обробіть всі шари Матеріалу 2

**Альтернатива:** Використовуйте окремі документи для різних матеріалів.

### Пауза між шарами

Ви можете налаштувати Rayforge на паузу між шарами. Це корисно, коли вам
потрібно:

- Змінити матеріал під час роботи
- Перевірити прогрес перед продовженням
- Налаштувати фокус для різних операцій

Щоб налаштувати паузи шарів, використовуйте функцію хуків у налаштуваннях машини.

### Специфічні налаштування шарів

Робочий процес кожного шару може мати унікальні налаштування:

| Шар       | Операція  | Швидкість   | Потужність | Проходи |
| --------- | --------- | ----------- | ---------- | ------- |
| Гравіювання | Растр   | 300 мм/хв   | 20%        | 1       |
| Надріз    | Контур    | 500 мм/хв   | 10%        | 1       |
| Різання   | Контур    | 100 мм/хв   | 90%        | 2       |

---

## Найкращі практики

### Угоди іменування

**Хороші імена шарів:**

- "Гравіювання - Логотип"
- "Різання - Зовнішній контур"
- "Надріз - Лінії згину"
- "Прохід 1 - Чорнове різання"
- "Прохід 2 - Фінальне різання"

**Погані імена шарів:**

- "Шар 1", "Шар 2" (не описові)
- Довгі описи (будьте лаконічними)

### Організація шарів

1. **Зверху вниз = порядок виконання**
2. **Гравіювання перед різанням** (загальне правило)
3. **Групуйте пов'язані операції** (все різання, все гравіювання)
4. **Використовуйте видимість** для фокусування на поточній роботі
5. **Видаляйте невикористані шари**, щоб зберігати проекти чистими

### Підготовка SVG-файлів для імпорту шарів

**Для найкращих результатів при імпорті шарів SVG:**

1. **Використовуйте панель Шарів** у вашому дизайнерському ПЗ для організації дизайну
2. **Призначте змістовні імена** кожному шару (наприклад, "Гравіювання", "Різання")
3. **Зберігайте шари пласкими** - уникайте розміщення шарів всередині інших шарів
4. **Збережіть ваш файл** та імпортуйте в Rayforge
5. **Перевірте виявлення шарів**, перевіривши діалог імпорту

Rayforge найкраще працює з SVG-файлами, створеними в Inkscape або подібному векторному
дизайнерському ПЗ, що підтримує шари.

### Продуктивність

**Багато шарів:**

- Немає значного впливу на продуктивність
- 10-20 шарів є звичайним для складних робіт
- Організовуйте логічно, не для мінімізації кількості шарів

**Спрощуйте за потреби:**

- Об'єднуйте подібні операції в один шар, коли можливо
- Використовуйте менше растрових гравіювань (найбільш ресурсомісткі)

---

## Виправлення проблем

### Шар не генерує G-код

**Проблема:** Шар з'являється в документі, але не в згенерованому G-коді.

**Рішення:**

1. **Перевірте, що шар має заготовки** - Порожні шари пропускаються
2. **Перевірте, що робочий процес налаштовано** - Шар потребує операції
3. **Перевірте налаштування операції** - Потужність > 0, дійсна швидкість тощо
4. **Перевірте видимість заготовки** - Приховані заготовки можуть не оброблятися
5. **Перегенеруйте G-код** - Зробіть невелику зміну для примусової регенерації

### Неправильний порядок шарів

**Проблема:** Операції виконуються в неочікуваному порядку.

**Рішення:** Змініть порядок шарів на панелі Шарів. Пам'ятайте: зверху = перший.

### Шари перекриваються в перегляді

**Проблема:** Кілька шарів показують перекриваючий вміст у перегляді.

**Пояснення:** Це нормально, якщо шари поділяють ту саму XY область.

**Рішення:**

- Використовуйте видимість шару, щоб тимчасово приховати інші шари
- Перевірте 3D перегляд, щоб побачити глибину/порядок
- Переконайтеся, що це навмисно (наприклад, гравіювання, потім різання тієї ж форми)

### Заготовка в неправильному шарі

**Проблема:** Заготовка була призначена до неправильного шару.

**Рішення:** Перетягніть заготовку на правильний шар на панелі Шарів або дереві Документа.

### Шари SVG не виявлені

**Проблема:** Імпорт SVG-файлу, але шари не з'являються в діалозі імпорту.

**Рішення:**

1. **Перевірте структуру SVG** - Відкрийте ваш файл в Inkscape або подібному ПЗ
    щоб перевірити, що він має шари
2. **Увімкніть "Використовувати оригінальні вектори"** - Вибір шарів доступний тільки в
    цьому режимі імпорту
3. **Перевірте, що ваш дизайн має шари** - Переконайтеся, що ви створили шари в вашому
    дизайнерському ПЗ, а не просто групи
4. **Перевірте на вкладені шари** - Шари всередині інших шарів можуть не бути
    виявлені правильно
5. **Перезбережіть ваш файл** - Іноді перезбереження з поточною версією
    вашого дизайнерського ПЗ допомагає

### Імпорт шарів SVG показує неправильний вміст

**Проблема:** Імпортований шар показує вміст з інших шарів або порожній.

**Рішення:**

1. **Перевірте вибір шарів** - Переконайтеся, що правильні шари увімкнені в
    діалозі імпорту
2. **Перевірте ваш дизайн** - Відкрийте оригінальний файл у вашому дизайнерському ПЗ
    щоб підтвердити, що кожен шар містить правильний вміст
3. **Перевірте на спільні елементи** - Елементи, що з'являються в кількох шарах
    можуть викликати плутанину
4. **Спробуйте режим трасування** - Використовуйте режим трасування як запасний варіант, якщо векторний імпорт має
    проблеми

---

## Пов'язані сторінки

- [Операції](./operations/contour) - Типи операцій для робочих процесів шарів
- [Режим симуляції](./simulation-mode) - Попередній перегляд багатошарового виконання
- [Макроси та хуки](../machine/hooks-macros) - Хуки рівня шару для автоматизації
- [3D перегляд](../ui/3d-preview) - Візуалізація стеку шарів
